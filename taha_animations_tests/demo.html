<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
  </head>
  <body>
    <script>
      var config = {
        type: Phaser.AUTO,
        width: 1920,
        height: 1080,
        physics: {
          default: "arcade",
          arcade: {
            gravity: { y: 200 },
          },
        },
        scene: {
          preload: preload,
          create: create,
          update: update,
        },
      };

      var stage;

      var game = new Phaser.Game(config);

      function preload() {
        this.load.image("space", "Space Background1.png");

        this.load.spritesheet("planet", "wetPlanetSheet.png", {
          frameWidth: 500,
          frameHeight: 500,
        });
        this.load.spritesheet("planet2", "marsPlanetSheet.png", {
          frameWidth: 250,
          frameHeight: 250,
        });
        this.load.spritesheet("planet3", "moonPlanetSheet.png", {
          frameWidth: 250,
          frameHeight: 250,
        });
        this.load.spritesheet("planet4", "lavaPlanetSheet.png", {
          frameWidth: 250,
          frameHeight: 250,
        });

        this.load.spritesheet("blackHole", "blackHoleSheet.png", {
          frameWidth: 500,
          frameHeight: 500,
        });
        this.load.spritesheet("star", "starSheet.png", {
          frameWidth: 500,
          frameHeight: 500,
        });
        this.load.spritesheet("galaxy", "galaxySheet.png", {
          frameWidth: 250,
          frameHeight: 250,
        });
        this.load.spritesheet("missile", "missile_flying.png", {
          frameWidth: 141,
          frameHeight: 517,
        });
        this.load.image("stationary_missile", "missile.png");

        this.load.image("asteroid1", "asteroid1.png");
        this.load.image("asteroid2", "asteroid2.png");
        this.load.image("asteroid3", "asteroid3.png");
        this.load.image("asteroid4", "asteroid4.png");
        this.load.image("asteroid5", "asteroid5.png");
        this.load.image("asteroid6", "asteroid6.png");
        this.load.image("asteroid7", "asteroid7.png");
        this.load.image("asteroid8", "asteroid8.png");
        this.load.image("asteroid9", "asteroid9.png");
        this.load.image("asteroid10", "asteroid10.png");
      }

      function create() {
        this.add.image(960, 540, "space");
        var asteroids = [
          "asteroid1",
          "asteroid2",
          "asteroid3",
          "asteroid4",
          "asteroid5",
          "asteroid6",
          "asteroid7",
          "asteroid8",
          "asteroid9",
          "asteroid10",
        ];
        var planets = ["planet", "planet2", "planet3", "planet"];
        var dangers = ["blackhole", "star", "galaxy"];

        this.anims.create({
          key: "wet_animate",
          frames: this.anims.generateFrameNumbers("planet"),
          frameRate: 7,
          repeat: -1,
        });

        this.anims.create({
          key: "dry_animate",
          frames: this.anims.generateFrameNumbers("planet2"),
          frameRate: 7,
          repeat: -1,
        });

        this.anims.create({
          key: "moon_animate",
          frames: this.anims.generateFrameNumbers("planet3"),
          frameRate: 7,
          repeat: -1,
        });

        this.anims.create({
          key: "lava_animate",
          frames: this.anims.generateFrameNumbers("planet4"),
          frameRate: 7,
          repeat: -1,
        });

        this.anims.create({
          key: "star_animate",
          frames: this.anims.generateFrameNumbers("star"),
          frameRate: 14,
          repeat: -1,
        });

        this.anims.create({
          key: "black_animate",
          frames: this.anims.generateFrameNumbers("blackHole"),
          frameRate: 7,
          repeat: -1,
        });

        this.anims.create({
          key: "galaxy_animate",
          frames: this.anims.generateFrameNumbers("galaxy"),
          frameRate: 7,
          repeat: -1,
        });

        this.anims.create({
          key: "rocket",
          frames: this.anims.generateFrameNumbers("missile"),
          frameRate: 10,
          repeat: -1,
        });

        plan = this.add.sprite(960, -2000).setScale(2.5);
        plan.angle = 0;
        plan.play("wet_animate");

        rocket = this.add.sprite(960, 600).setScale(0.5);
        rocket.angle = 0;
        rocket.play("rocket");

        this.cursors = this.input.keyboard.addKeys("LEFT,RIGHT,UP,DOWN");

        init = false;
        correct = false;
        incorrect = false;
        play_animation1 = false;
        play_animation2 = false;
        game_over = false;
        rock_counter = 0;
        generate_new_rock = true
        var text;

        var Game = new Phaser.Class({

          initialize: function Game() {},

          init: function (space, planet, rocket) {
            if (planet.y < 1500) {
              planet.y += 10;
              return [false, rocket];
            } else if (rocket.y < 850) {
              rocket.y += 10;
              return [false, rocket];
            }
            if (rocket.y > 849) {
              rocket.destroy();
              rocket = space.add
                .image(960, 850, "stationary_missile")
                .setScale(0.5);
              return [true, rocket];
            }
          },



          text_display: function(space, identifier, txt){
              switch(identifier){
                case 0:
                    txt.destroy();
              }
          },

          rocks_fly: function (space) {
            var chooser = Phaser.Math.RND.integerInRange(1,10);
            var position = Phaser.Math.RND.integerInRange(0,1);
            switch(chooser){
                case 1:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid1').setScale(0.2)
                    break;
                case 2:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid2').setScale(0.2)
                    break;
                case 3:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid3').setScale(0.2)
                    break;
                case 4:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid4').setScale(0.2)
                    break;
                case 5:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid5').setScale(0.2)
                    break;
                case 6:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid6').setScale(0.2)
                    break;
                case 7:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid7').setScale(0.2)
                    break;
                case 8:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid8').setScale(0.2)
                    break;
                case 9:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid9').setScale(0.2)
                    break;
                case 10:
                    return space.add.image(200 + (position * 1000),-1000, 'asteroid10').setScale(0.2)
                    break;
                default:
                    return space.add.image(200 + (position * 1000), -1000, 'asteroid1').setScale(0.2)
                    
            }
          },
        });

        stage = new Game(this, asteroids);
      }

      function update() {
        // if(init == false){
        //     if(plan.y < 1500){
        //         plan.y += 10
        //     }
        //     else if(rocket.y < 850){
        //         rocket.y += ((850-rocket.y) / 16)+1;
        //     }
        //     if(rocket.y > 849){
        //         rocket.destroy();
        //         rocket = this.add.image(960,850, 'stationary_missile').setScale(0.5)
        //         init = true
        //     }
        // }
        if (init == false) {
          values = stage.init(this, plan, rocket);
          init = values[0];
          rocket = values[1];
        }

        if (this.cursors.LEFT.isDown && play_animation2 == false) {
          init = false;
          correct = false;
          incorrect = false;
          play_animation1 = false;
          play_animation2 = false;
          game_over = false;

          rocket.destroy();
          plan.destroy();

          plan = this.add.sprite(960, -2000).setScale(2.5);
          plan.angle = 0;
          plan.play("wet_animate");

          rocket = this.add.sprite(960, 600).setScale(0.5);
          rocket.angle = 0;
          rocket.play("rocket");

          text.destroy();
        } else if (play_animation1 == false && this.cursors.UP.isDown) {
          var chooser = Phaser.Math.RND.integerInRange(0, 3);
          correct = true;
          incorrect = false;
          play_animation1 = true;
          difference = -2000;
        } else if (this.cursors.DOWN.isDown && play_animation2 == false) {
          var chooser = Phaser.Math.RND.integerInRange(0, 2);
          incorrect = true;
          correct = false;
          play_animation2 = true;
        }
        else if (this.cursors.RIGHT.isDown){
          this.add.displayList.removeAll();
        }











        //Initialises correct animation
        if (correct == true) {
          plan2 = this.add.sprite(960, difference);

          text = this.add.text(720, 340, "", {
            font: "128px Impact",
            fill: "#7200FF",
          });
          text.setText(["CORRECT"]);

          switch (chooser) {
            case 0:
              plan2.setScale(5);
              plan2.play("dry_animate");
              break;
            case 1:
              plan2.setScale(2.5);
              plan2.play("wet_animate");
              break;
            case 2:
              plan2.setScale(5);
              plan2.play("moon_animate");
              break;
            case 3:
              plan2.setScale(5);
              plan2.play("lava_animate");
              break;
            default:
              plan2.setScale(2.5);
              plan2.play("wet_animate");
          }
          y = rocket.y;
          rocket.destroy();
          rocket = this.add.sprite(960, y).setScale(0.5);
          rocket.play("rocket");

          //this.add.image(960, 540, 'space');

          correct = false;
        }

        //play the correct animation
        if (play_animation1 == true) {
          if (rocket.y > 600 && plan.y < 5000) {
            rocket.y += -((850 - rocket.y) / 16 + 1);
          } else if (plan.y < 2000) {
            plan.y += 10;
            plan2.y += 10;
          } else if (rock_counter < 5){
            if(generate_new_rock){
                rock = stage.rocks_fly(this)
                generate_new_rock = false
            }
            if(rock.y < 1500){
                rock.angle += 5
                rock.y += 7
            }
            else{
                rock_counter += 1
                generate_new_rock = true
            }
        } else if (plan.y < 1000) {
            plan.y += 10;
            plan2.y += 10;
        }else if (rocket.y < 850) {
            rocket.y += (850 - rocket.y) / 16 + 1;
          }
          if (rocket.y > 849) {
            rocket.destroy();
            rocket = this.add
              .image(960, 835, "stationary_missile")
              .setScale(0.5);
            play_animation1 = false;
            plan.destroy();
            console.log(text);
            text.destroy();
            console.log(text);
            //game.text_display(this, 0, text);
            plan = plan2;
          }
        }










        //Initialsies incorrect animation
        if (incorrect == true) {
          danger = this.add.sprite(960, -2000);

          switch (chooser) {
            case 0:
              danger.setScale(2);
              danger.play("black_animate");
              break;
            case 1:
              danger.setScale(2.5);
              danger.play("star_animate");
              break;
            case 2:
              danger.setScale(5);
              danger.play("galaxy_animate");
              break;
            default:
              danger.setScale(2.5);
              danger.play("black_animate");
          }

          rocket.destroy();
          rocket = this.add.sprite(960, 850).setScale(0.5);
          scale = 0.5;
          rocket.play("rocket");
          incorrect = false;
        }

        //Play incorrect animation
        if (play_animation2 == true) {
          if (rocket.y > 650 && plan.y < 3750) {
            rocket.y += -((850 - rocket.y) / 16 + 1);
          } else if (plan.y < 3750) {
            plan.y += 10;
            danger.y += 10;
          } else if (this.cursors.DOWN.isDown) {
            game_over = true;
          } else if (scale < 0.05) {
            rocket.destroy();
            plan.destroy();
            plan = danger;
            play_animation2 = false;

            text = this.add.text(665, 480, "", {
              font: "128px Impact",
              fill: "#7200FF",
            });

            text.setText(["GAME OVER"]);
          } else if (game_over == true) {
            rocket.setScale(scale);
            scale += -0.03;
            rocket.angle += 30;
            rocket.y += -((850 - rocket.y) / 15 + 1);
          } else if (this.cursors.UP.isDown) {
            plan.destroy();
            plan = danger;
            play_animation2 = false;
            correct = true;
            play_animation1 = true;
            difference = -3250;
          }
        }
      }
    </script>
  </body>
</html>
